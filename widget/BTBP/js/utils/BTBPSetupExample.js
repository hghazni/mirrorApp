(function(){function n(){f.clickArea.mouseEnabled=!1;f.imageContainer.removeAllChildren();l&&l.hideAll&&l.hideAll();var a=d.height;d.height>d.width&&(a=d.width);e.setMode(btbpv4.BTBPMode.FACE_TRACKING);e.setNumFacesToTrack(1);e.setFaceDetectionRoi(d);e.setFaceDetectionParams(.3*a,1*a,12,8);e.setFaceTrackingStartParams(.3*a,1*a,22,26,22);e.setFaceTrackingResetParams(.25*a,1*a,40,55,32);c.initCurrentExample(e,d,f);m=!1;if(b.isStream())f.setUpdateCallback(p);else{f.clear();a=h.getElement("_imageData");
b.update();for(var g=a.getContext("2d").getImageData(0,0,d.width,d.height).data,a=0;10>a;a++)e.update(g);setTimeout(function(){c.updateCurrentExample(e,g,f)},100)}}function p(){if(!m){k.start&&k.start();var a=h.getElement("_imageData");b.update();c.updateCurrentExample(e,a.getContext("2d").getImageData(0,0,d.width,d.height).data,f);k.end&&k.end()}}var c=btbpExample,b=c.imageData,h=c.dom,k=c.stats,f=c.drawing,l=c.drawing3d.t3d,g=c.trace,e=null,d=null,m=!0;initializeBTBP(btbpv4);f.setup&&!f.stage&&
f.setup(h.getElement("_drawing"),h.getElement("_faceSub"),30);k.init&&k.init(30);c.reinit=function(){c.init(b.type())};b.onAvailable=function(a,b){g("imageData.onAvailable: "+a+"x"+b);h.updateLayout(a,b);d.setTo(0,0,a,b);f.updateLayout(a,b);c.reinit()};c.waitForSDK=function(){btbpv4.sdkReady?(g("waitForSDK: done."),c.init()):(g("waitForSDK: still waiting."),clearTimeout(c.waitForSDK_timeout),c.waitForSDK_timeout=setTimeout(function(){c.waitForSDK()},100))};c.init=function(a){m=!0;b.type&&a!==b.type()&&
b.isAvailable()&&(f.setUpdateCallback(null),g("imageData.dispose: "+b.type()),b.dispose());g("init: type: "+a);btbpv4.sdkReady?(g("-> btbpv4.sdkReady: "+btbpv4.sdkReady),btbpv4.BTBPManager&&!e&&(e=new btbpv4.BTBPManager),btbpv4.Rectangle&&!d&&(d=new btbpv4.Rectangle(0,0,640,480)),null===e||null===d?g("Init failed!",!0):("picture"===a?b.picture.setup(h.getElement("_imageData"),b.onAvailable):b.webcam.setup(h.getElement("_webcam"),h.getElement("_imageData"),d,b.onAvailable),g("-> imageData.isAvailable ("+
b.type()+"): "+b.isAvailable()),b.isAvailable()?n():(d.setTo(0,0,640,480),b.init()))):c.waitForSDK()}})();
